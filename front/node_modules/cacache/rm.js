'use strict'

const BB = require('cacache/node_modules/cacache/node_modules/bluebird')

const index = require('cacache/node_modules/cacache/lib/entry-index')
const memo = require('cacache/lib/memoization')
const path = require('path')
const rimraf = BB.promisify(require('cacache/node_modules/cacache/node_modules/rimraf'))
const rmContent = require('cacache/node_modules/cacache/lib/content/rm')

module.exports = entry
module.exports.entry = entry
function entry (cache, key) {
  memo.clearMemoized()
  return index.delete(cache, key)
}

module.exports.content = content
function content (cache, integrity) {
  memo.clearMemoized()
  return rmContent(cache, integrity)
}

module.exports.all = all
function all (cache) {
  memo.clearMemoized()
  return rimraf(path.join(cache, '*(content-*|index-*)'))
}
