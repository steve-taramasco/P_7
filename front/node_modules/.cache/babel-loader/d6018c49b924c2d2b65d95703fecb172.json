{"remainingRequest":"/Users/steve/Git/Groupomania/front/node_modules/babel-loader/lib/index.js!/Users/steve/Git/Groupomania/front/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/steve/Git/Groupomania/front/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/steve/Git/Groupomania/front/src/views/posts/Posts.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/steve/Git/Groupomania/front/src/views/posts/Posts.vue","mtime":1612993992278},{"path":"/Users/steve/Git/Groupomania/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/steve/Git/Groupomania/front/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/steve/Git/Groupomania/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/steve/Git/Groupomania/front/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdQb3N0JywKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcG9zdHM6IG51bGwsCiAgICAgIG1lc3NhZ2U6IG51bGwsCiAgICAgIHVzZXJJZDogc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndXNlcklkJyksCiAgICAgIHRva2VuOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpCiAgICB9OwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0UG9zdHMoKSwgY29uc29sZS5sb2codGhpcy5wb3N0cyk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBnZXREYXRlOiBmdW5jdGlvbiBnZXREYXRlKGRhdGUpIHsKICAgICAgdmFyIGRhdGVfZm9ybWF0ZXIgPSBuZXcgRGF0ZShkYXRlKS50b0lTT1N0cmluZygpLnNsaWNlKDAsIDE5KS5yZXBsYWNlKCdUJywgJyAnKTsKICAgICAgcmV0dXJuIGRhdGVfZm9ybWF0ZXI7CiAgICB9LAogICAgZ2V0UG9zdHM6IGZ1bmN0aW9uIGdldFBvc3RzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgYXhpb3MuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3Bvc3RzLycsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiQXV0aG9yaXphdGlvbiI6ICJCZWFyZXIgIi5jb25jYXQodGhpcy50b2tlbikKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzLnBvc3RzID0gcmVzLmRhdGEucG9zdHM7IC8vIGxldCBkYXRlID0gdGhpcy5wb3N0c1swXS5jcmVhdGVkQXQ7CiAgICAgICAgLy8gY29uc29sZS5sb2coZGF0ZSksCiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5nZXREYXRlKGRhdGUpKQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZXR1cm4gY29uc29sZS5sb2coewogICAgICAgICAgZXJyb3I6IGVycm9yCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIHRyYXNoOiBmdW5jdGlvbiB0cmFzaChpZCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIGF4aW9zLmRlbGV0ZSgnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9wb3N0cy8nICsgaWQsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiQXV0aG9yaXphdGlvbiI6ICJCZWFyZXIgIi5jb25jYXQodGhpcy50b2tlbikKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBfdGhpczIuZ2V0UG9zdHMoKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgfSk7CiAgICB9LAogICAgc2VuZDogZnVuY3Rpb24gc2VuZCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBheGlvcy5wb3N0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3Bvc3RzLycsIHsKICAgICAgICBkYXRhOiB7CiAgICAgICAgICBtZXNzYWdlOiB0aGlzLm1lc3NhZ2UsCiAgICAgICAgICB1c2VySWQ6IHRoaXMudXNlcklkCiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgIkF1dGhvcml6YXRpb24iOiAiQmVhcmVyICIuY29uY2F0KHRoaXMudG9rZW4pCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczMubWVzc2FnZSA9IG51bGwsIF90aGlzMy5nZXRQb3N0cygpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZXR1cm4gY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["/Users/steve/Git/Groupomania/front/src/views/posts/Posts.vue"],"names":[],"mappings":";;;AA8CA,OAAO,KAAP,MAAkB,OAAlB;AACA,eAAe;AACb,EAAA,IAAI,EAAE,MADO;AAEb,EAAA,IAFa,kBAEL;AACN,WAAO;AACL,MAAA,KAAK,EAAE,IADF;AAEL,MAAA,OAAO,EAAE,IAFJ;AAGL,MAAA,MAAM,EAAE,cAAc,CAAC,OAAf,CAAuB,QAAvB,CAHH;AAIL,MAAA,KAAI,EAAI,cAAc,CAAC,OAAf,CAAuB,OAAvB;AAJH,KAAP;AAMD,GATY;AAWb,EAAA,OAXa,qBAWF;AACT,SAAK,QAAL,IACA,OAAO,CAAC,GAAR,CAAY,KAAK,KAAjB,CADA;AAED,GAdY;AAiBb,EAAA,OAAO,EAAE;AAEP,IAAA,OAFO,mBAEC,IAFD,EAEO;AACZ,UAAI,aAAY,GAAI,IAAI,IAAJ,CAAS,IAAT,EAAe,WAAf,GAA6B,KAA7B,CAAmC,CAAnC,EAAsC,EAAtC,EAA0C,OAA1C,CAAkD,GAAlD,EAAuD,GAAvD,CAApB;AACA,aAAO,aAAP;AACD,KALM;AAOP,IAAA,QAPO,sBAOI;AAAA;;AACT,MAAA,KAAK,CAAC,GAAN,CAAU,kCAAV,EACA;AACE,QAAA,OAAO,EAAE;AAAE,4CAA6B,KAAK,KAAlC;AAAF;AADX,OADA,EAIC,IAJD,CAIM,UAAA,GAAE,EAAK;AACX,QAAA,KAAI,CAAC,KAAL,GAAa,GAAG,CAAC,IAAJ,CAAS,KAAtB,CADW,CAGX;AACA;AACA;AACD,OAVD,EAWC,KAXD,CAWO,UAAA,KAAI;AAAA,eAAK,OAAO,CAAC,GAAR,CAAY;AAAE,UAAA,KAAI,EAAJ;AAAF,SAAZ,CAAL;AAAA,OAXX;AAYD,KApBM;AAsBP,IAAA,KAtBO,iBAsBD,EAtBC,EAsBG;AAAA;;AACR,MAAA,KAAK,CAAC,MAAN,CAAa,qCAAqC,EAAlD,EACA;AACI,QAAA,OAAO,EAAE;AAAE,4CAA6B,KAAK,KAAlC;AAAF;AADb,OADA,EAIC,IAJD,CAIM;AAAA,eAAM,MAAI,CAAC,QAAL,EAAN;AAAA,OAJN,EAKC,KALD,CAKO,UAAA,KAAI;AAAA,eAAK,OAAO,CAAC,GAAR,CAAY,KAAZ,CAAL;AAAA,OALX;AAMD,KA7BM;AA+BP,IAAA,IA/BO,kBA+BA;AAAA;;AACL,MAAA,KAAK,CAAC,IAAN,CAAW,kCAAX,EACA;AACE,QAAA,IAAI,EAAE;AACJ,UAAA,OAAO,EAAE,KAAK,OADV;AAEJ,UAAA,MAAM,EAAE,KAAK;AAFT;AADR,OADA,EAOA;AACE,QAAA,OAAO,EAAE;AAAE,4CAA6B,KAAK,KAAlC;AAAF;AADX,OAPA,EAUC,IAVD,CAUM,YAAM;AAAE,QAAA,MAAI,CAAC,OAAL,GAAe,IAAf,EAAqB,MAAI,CAAC,QAAL,EAArB;AAAsC,OAVpD,EAWC,KAXD,CAWO,UAAA,KAAI;AAAA,eAAK,OAAO,CAAC,GAAR,CAAY,KAAZ,CAAL;AAAA,OAXX;AAYF;AA5CO;AAjBI,CAAf","sourcesContent":["<template>\n\n  <div class=\"content\" v-if=\"posts\">\n    <div class=\"posts\" v-for=\"post in posts\" :key=\"post\">\n\n      <div class=\"user\">\n        <ion-icon name=\"person-circle-outline\" class=\"icon\"></ion-icon>\n        <p v-if=\"post.user\">@ {{ post.user.username }}</p>\n        <p v-else>@ inconnu</p>\n      </div>\n\n      <div class=\"post\">\n        <div class=\"bulle\">\n          <p>{{ post.message }}</p>\n          <p>\n            <router-link :to=\"{ name: 'PostDetails', params: { id: post.id }}\">\n              <span class=\"comments\">{{ post.comments.length }}</span>\n              commentaires \n            </router-link>\n            \n            <span class=\"trash\" @click=\"trash(post.id)\">suppr.</span>\n          </p>\n        </div>\n      </div>\n      <div class=\"time\">\n          {{ post.createdAt }}\n      </div>\n      \n    </div>\n    <form>\n        <input type=\"text\" v-model=\"message\" placeholder=\"message...\">\n        <button type=\"button\" @click=\"send\">Envoyer</button>\n    </form> \n  </div>\n\n  <div class=\"loading\" v-else>\n    <p>loading...</p>\n     <form>\n        <input type=\"text\" v-model=\"message\" placeholder=\"message...\">\n        <button type=\"button\" @click=\"send\">Envoyer</button>\n    </form> \n  </div>\n\n</template>\n\n<script>\nimport axios from 'axios'\nexport default {\n  name: 'Post',\n  data () {\n    return {\n      posts: null,\n      message: null,\n      userId: sessionStorage.getItem('userId'),\n      token : sessionStorage.getItem('token'),\n    }\n  },\n\n  mounted () {\n    this.getPosts(),\n    console.log(this.posts)\n  },\n\n\n  methods: {\n\n    getDate(date) {\n      let date_formater = new Date(date).toISOString().slice(0, 19).replace('T', ' ');\n      return date_formater;\n    },\n\n    getPosts() {\n      axios.get('http://localhost:3000/api/posts/',\n      {\n        headers: { \"Authorization\" : `Bearer ${ this.token }` }\n      })\n      .then(res => {\n        this.posts = res.data.posts;\n\n        // let date = this.posts[0].createdAt;\n        // console.log(date),\n        // console.log(this.getDate(date))\n      })\n      .catch(error => console.log({ error }));\n    },\n\n    trash(id) {\n      axios.delete('http://localhost:3000/api/posts/' + id,\n      {\n          headers: { \"Authorization\" : `Bearer ${ this.token }` }\n      })\n      .then(() => this.getPosts())\n      .catch(error => console.log(error));\n    },\n    \n    send() {\n      axios.post('http://localhost:3000/api/posts/',\n      {\n        data: {\n          message: this.message,\n          userId: this.userId\n        }\n      },\n      {\n        headers: { \"Authorization\" : `Bearer ${ this.token }` }\n      })\n      .then(() => { this.message = null, this.getPosts() })\n      .catch(error => console.log(error));   \n    }\n\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.content {\n  margin-bottom: 5em;\n}\n\n.posts {\n  display: flex;\n  margin: 3em 0;\n  .user {\n    flex: 1;\n    margin: 5px;\n\n    p {\n        margin: 0;\n      }\n    .icon {\n      width: 3em;\n      height: 3em;\n    }\n  }\n\n  .post {\n    flex: 3;\n\n    .bulle {\n      background-color: whitesmoke;\n      border-radius: 10px;\n      margin: 5px;\n      padding: .4em;\n\n      p:nth-child(1) {\n        font-weight: bold;\n      }\n      a {\n        text-decoration: none;\n        color: inherit;\n      }\n      &:hover {\n        margin: 5px;\n        box-shadow: 0px 0px 10px 1px darkgrey;\n      }\n    }\n  }\n  .time {\n    flex: 1;\n  }\n}\n\nform {\n  padding: 1em;\n  border-top: solid 2px lightgrey;\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  background: white;\n  width: -webkit-fill-available;\n  input {\n      margin-right: 2em;\n      padding: .3em 1em;\n      width: 15em;\n      border-radius: 4px;\n      border: 1px solid darkgray;\n      &:focus {\n          outline: none;\n          box-shadow: 0px 0px 5px darkgrey;\n      }\n  }\n}\n</style>"],"sourceRoot":""}]}